Author: aszlig <aszlig@nix.build>
Date:   Fri Mar 30 20:29:49 2018 +0200

    Remove community guidelines
    
    The standalone version is invite-only anyways and the community
    guidelines really vary from installation to installation, so let's get
    rid of that.
    
    Signed-off-by: aszlig <aszlig@nix.build>
    Filename: remove-community-guidelines.patch

diff --git a/website/client/components/chat/chatCard.vue b/website/client/components/chat/chatCard.vue
index be680634c..1bb17be30 100644
--- a/website/client/components/chat/chatCard.vue
+++ b/website/client/components/chat/chatCard.vue
@@ -21,10 +21,9 @@ div
       span.action(v-if='!inbox', @click='copyAsTodo(msg)')
         .svg-icon(v-html="icons.copy")
         | {{$t('copyAsTodo')}}
-      span.action(v-if='!inbox && user.flags.communityGuidelinesAccepted && msg.uuid !== "system"', @click='report(msg)')
+      span.action(v-if='!inbox && msg.uuid !== "system"', @click='report(msg)')
         .svg-icon(v-html="icons.report")
         | {{$t('report')}}
-        // @TODO make flagging/reporting work in the inbox. NOTE: it must work even if the communityGuidelines are not accepted and it MUST work for messages that you have SENT as well as received. -- Alys
       span.action(v-if='msg.uuid === user._id || inbox || user.contributor.admin', @click='remove()')
         .svg-icon(v-html="icons.delete")
         | {{$t('delete')}}
diff --git a/website/client/components/groups/group.vue b/website/client/components/groups/group.vue
index 647d4ad5b..c9125d840 100644
--- a/website/client/components/groups/group.vue
+++ b/website/client/components/groups/group.vue
@@ -37,7 +37,6 @@
             button.btn.btn-secondary.float-left(v-once, @click='reverseChat()') {{ $t('reverseChat') }}
           .col-6.chat-send-actions
             button.btn.btn-secondary.send-chat.float-right(v-once, @click='sendMessage()') {{ $t('send') }}
-        community-guidelines
         .row(v-if='showNoNotificationsMessage')
           .col-12.no-notifications
             | {{$t('groupNoNotifications')}}
@@ -332,7 +331,6 @@ import groupChallenges from '../challenges/groupChallenges';
 import groupGemsModal from 'client/components/groups/groupGemsModal';
 import questSidebarSection from 'client/components/groups/questSidebarSection';
 import markdownDirective from 'client/directives/markdown';
-import communityGuidelines from './communityGuidelines';
 
 import deleteIcon from 'assets/svg/delete.svg';
 import copyIcon from 'assets/svg/copy.svg';
@@ -363,7 +361,6 @@ export default {
     questDetailsModal,
     groupGemsModal,
     questSidebarSection,
-    communityGuidelines,
   },
   directives: {
     markdown: markdownDirective,
@@ -473,9 +470,6 @@ export default {
     },
   },
   methods: {
-    acceptCommunityGuidelines () {
-      this.$store.dispatch('user:set', {'flags.communityGuidelinesAccepted': true});
-    },
     async load () {
       if (this.isParty) {
         this.searchId = 'party';
diff --git a/website/client/components/groups/tavern.vue b/website/client/components/groups/tavern.vue
index 63ac66241..695bbc973 100644
--- a/website/client/components/groups/tavern.vue
+++ b/website/client/components/groups/tavern.vue
@@ -12,7 +12,7 @@
         h3(v-once) {{ $t('tavernChat') }}
 
         .row
-          textarea(:placeholder="$t('tavernCommunityGuidelinesPlaceholder')", v-model='newMessage', :class='{"user-entry": newMessage}', @keydown='updateCarretPosition', @keyup.ctrl.enter='sendMessage()')
+          textarea(v-model='newMessage', :class='{"user-entry": newMessage}', @keydown='updateCarretPosition', @keyup.ctrl.enter='sendMessage()')
           autocomplete(:text='newMessage', v-on:select="selectedAutocomplete", :coords='coords', :chat='group.chat')
 
         .row
@@ -22,8 +22,6 @@
           .col-6
             button.btn.btn-secondary.send-chat.float-right(v-once, @click='sendMessage()') {{ $t('send') }}
 
-        community-guidelines
-
         .row
           .hr.col-12
           chat-message(:chat.sync='group.chat', :group-id='group._id', :group-name='group.name')
@@ -133,8 +131,6 @@
               .svg-icon(v-html="icons.downIcon")
         .section.row(v-if="sections.helpfulLinks")
           ul
-            li
-             router-link(to='/static/community-guidelines', v-once) {{ $t('communityGuidelinesLink') }}
             li
               router-link(to="/groups/guild/f2db2a7f-13c5-454d-b3ee-ea1f5089e601") {{ $t('lookingForGroup') }}
             li
@@ -519,7 +515,6 @@ import { mapState } from 'client/libs/store';
 import { TAVERN_ID } from '../../../common/script/constants';
 import chatMessage from '../chat/chatMessages';
 import autocomplete from '../chat/autoComplete';
-import communityGuidelines from './communityGuidelines';
 import worldBossInfoModal from '../world-boss/worldBossInfoModal';
 import worldBossRageModal from '../world-boss/worldBossRageModal';
 
@@ -551,7 +546,6 @@ export default {
   components: {
     chatMessage,
     autocomplete,
-    communityGuidelines,
     worldBossInfoModal,
     worldBossRageModal,
   },
diff --git a/website/client/components/userMenu/profile.vue b/website/client/components/userMenu/profile.vue
index bfb40a095..4ce444ce0 100644
--- a/website/client/components/userMenu/profile.vue
+++ b/website/client/components/userMenu/profile.vue
@@ -79,8 +79,6 @@ div
       .row(v-if='editing')
         h1 {{$t('editProfile')}}
         .col-12
-          .alert.alert-info.alert-sm(v-html='$t("communityGuidelinesWarning", managerEmail)')
-
           .form-group
             label {{ $t('displayName') }}
             input.form-control(type='text', :placeholder="$t('fullName')", v-model='editingProfile.name')
diff --git a/website/client/router.js b/website/client/router.js
index ea2ed6c92..c5f8fab3c 100644
--- a/website/client/router.js
+++ b/website/client/router.js
@@ -13,7 +13,6 @@ const HomePage = () => import(/* webpackChunkName: "entry" */'./components/stati
 
 const AppPage = () => import(/* webpackChunkName: "static" */'./components/static/app');
 const ClearBrowserDataPage = () => import(/* webpackChunkName: "static" */'./components/static/clearBrowserData');
-const CommunityGuidelinesPage = () => import(/* webpackChunkName: "static" */'./components/static/communityGuidelines');
 const FAQPage = () => import(/* webpackChunkName: "static" */'./components/static/faq');
 const FeaturesPage = () => import(/* webpackChunkName: "static" */'./components/static/features');
 const GroupPlansPage = () => import(/* webpackChunkName: "static" */'./components/static/groupPlans');
@@ -243,7 +242,6 @@ const router = new VueRouter({
       children: [
         { name: 'app', path: 'app', component: AppPage, meta: {requiresLogin: false}},
         { name: 'clearBrowserData', path: 'clear-browser-data', component: ClearBrowserDataPage, meta: {requiresLogin: false}},
-        { name: 'communityGuidelines', path: 'community-guidelines', component: CommunityGuidelinesPage, meta: {requiresLogin: false}},
         { name: 'faq', path: 'faq', component: FAQPage, meta: {requiresLogin: false}},
         { name: 'features', path: 'features', component: FeaturesPage, meta: {requiresLogin: false}},
         { name: 'groupPlans', path: 'group-plans', component: GroupPlansPage, meta: {requiresLogin: false}},
diff --git a/website/server/controllers/api-v3/user.js b/website/server/controllers/api-v3/user.js
index 25527ae42..effe7b423 100644
--- a/website/server/controllers/api-v3/user.js
+++ b/website/server/controllers/api-v3/user.js
@@ -189,7 +189,6 @@ let updatablePaths = [
   'flags.showTour',
   'flags.tour',
   'flags.tutorial',
-  'flags.communityGuidelinesAccepted',
   'flags.welcomed',
   'flags.cardReceived',
   'flags.warnedLowHealth',
diff --git a/website/server/models/user/schema.js b/website/server/models/user/schema.js
index 9d8a9f09e..29534fb14 100644
--- a/website/server/models/user/schema.js
+++ b/website/server/models/user/schema.js
@@ -216,7 +216,6 @@ let schema = new Schema({
     // Used to enable weekly recap emails as users login
     lastWeeklyRecapDiscriminator: Boolean,
     onboardingEmailsPhase: String, // Keep track of the latest onboarding email sent
-    communityGuidelinesAccepted: {type: Boolean, default: false},
     cronCount: {type: Number, default: 0},
     welcomed: {type: Boolean, default: false},
     armoireEnabled: {type: Boolean, default: true},
