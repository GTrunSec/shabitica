Author: aszlig <aszlig@nix.build>
Date:   Fri Mar 30 20:29:49 2018 +0200

    Remove community guidelines
    
    The standalone version is invite-only anyways and the community
    guidelines really vary from installation to installation, so let's get
    rid of that.
    
    Signed-off-by: aszlig <aszlig@nix.build>
    Filename: remove-community-guidelines.patch

diff --git a/website/client/components/chat/chatCard.vue b/website/client/components/chat/chatCard.vue
index be680634c..1bb17be30 100644
--- a/website/client/components/chat/chatCard.vue
+++ b/website/client/components/chat/chatCard.vue
@@ -21,10 +21,9 @@ div
       span.action(v-if='!inbox', @click='copyAsTodo(msg)')
         .svg-icon(v-html="icons.copy")
         | {{$t('copyAsTodo')}}
-      span.action(v-if='!inbox && user.flags.communityGuidelinesAccepted && msg.uuid !== "system"', @click='report(msg)')
+      span.action(v-if='!inbox && msg.uuid !== "system"', @click='report(msg)')
         .svg-icon(v-html="icons.report")
         | {{$t('report')}}
-        // @TODO make flagging/reporting work in the inbox. NOTE: it must work even if the communityGuidelines are not accepted and it MUST work for messages that you have SENT as well as received. -- Alys
       span.action(v-if='msg.uuid === user._id || inbox || user.contributor.admin', @click='remove()')
         .svg-icon(v-html="icons.delete")
         | {{$t('delete')}}
diff --git a/website/client/components/groups/chat.vue b/website/client/components/groups/chat.vue
index 2ba54afb4..e4c1414b9 100644
--- a/website/client/components/groups/chat.vue
+++ b/website/client/components/groups/chat.vue
@@ -24,8 +24,6 @@
         .col-6.chat-send-actions
           button.btn.btn-secondary.send-chat.float-right(v-once, @click='sendMessage()') {{ $t('send') }}
 
-      community-guidelines
-
       slot(
         name="additionRow",
       )
@@ -39,14 +37,12 @@
   import debounce from 'lodash/debounce';
 
   import autocomplete from '../chat/autoComplete';
-  import communityGuidelines from './communityGuidelines';
   import chatMessage from '../chat/chatMessages';
 
   export default {
     props: ['label', 'group', 'placeholder'],
     components: {
       autocomplete,
-      communityGuidelines,
       chatMessage,
     },
     data () {
diff --git a/website/client/components/groups/group.vue b/website/client/components/groups/group.vue
index c332435de..f7d150d39 100644
--- a/website/client/components/groups/group.vue
+++ b/website/client/components/groups/group.vue
@@ -387,9 +387,6 @@ export default {
     },
   },
   methods: {
-    acceptCommunityGuidelines () {
-      this.$store.dispatch('user:set', {'flags.communityGuidelinesAccepted': true});
-    },
     async load () {
       if (this.isParty) {
         this.searchId = 'party';
diff --git a/website/client/components/groups/tavern.vue b/website/client/components/groups/tavern.vue
index 08bb0a384..d38eca6d3 100644
--- a/website/client/components/groups/tavern.vue
+++ b/website/client/components/groups/tavern.vue
@@ -10,7 +10,6 @@
     chat(
       :label="$t('tavernChat')",
       :group="group",
-      :placeholder="$t('tavernCommunityGuidelinesPlaceholder')",
       @fetchRecentMessages="fetchRecentMessages()"
     )
   .col-12.col-sm-4.sidebar
@@ -101,8 +100,6 @@
 
       sidebar-section(:title="$t('helpfulLinks')")
         ul
-          li
-           router-link(to='/static/community-guidelines', v-once) {{ $t('communityGuidelinesLink') }}
           li
             router-link(to="/groups/guild/f2db2a7f-13c5-454d-b3ee-ea1f5089e601") {{ $t('lookingForGroup') }}
           li
diff --git a/website/client/components/userMenu/profile.vue b/website/client/components/userMenu/profile.vue
index bfb40a095..4ce444ce0 100644
--- a/website/client/components/userMenu/profile.vue
+++ b/website/client/components/userMenu/profile.vue
@@ -79,8 +79,6 @@ div
       .row(v-if='editing')
         h1 {{$t('editProfile')}}
         .col-12
-          .alert.alert-info.alert-sm(v-html='$t("communityGuidelinesWarning", managerEmail)')
-
           .form-group
             label {{ $t('displayName') }}
             input.form-control(type='text', :placeholder="$t('fullName')", v-model='editingProfile.name')
diff --git a/website/client/router.js b/website/client/router.js
index ea2ed6c92..c5f8fab3c 100644
--- a/website/client/router.js
+++ b/website/client/router.js
@@ -13,7 +13,6 @@ const HomePage = () => import(/* webpackChunkName: "entry" */'./components/stati
 
 const AppPage = () => import(/* webpackChunkName: "static" */'./components/static/app');
 const ClearBrowserDataPage = () => import(/* webpackChunkName: "static" */'./components/static/clearBrowserData');
-const CommunityGuidelinesPage = () => import(/* webpackChunkName: "static" */'./components/static/communityGuidelines');
 const FAQPage = () => import(/* webpackChunkName: "static" */'./components/static/faq');
 const FeaturesPage = () => import(/* webpackChunkName: "static" */'./components/static/features');
 const GroupPlansPage = () => import(/* webpackChunkName: "static" */'./components/static/groupPlans');
@@ -243,7 +242,6 @@ const router = new VueRouter({
       children: [
         { name: 'app', path: 'app', component: AppPage, meta: {requiresLogin: false}},
         { name: 'clearBrowserData', path: 'clear-browser-data', component: ClearBrowserDataPage, meta: {requiresLogin: false}},
-        { name: 'communityGuidelines', path: 'community-guidelines', component: CommunityGuidelinesPage, meta: {requiresLogin: false}},
         { name: 'faq', path: 'faq', component: FAQPage, meta: {requiresLogin: false}},
         { name: 'features', path: 'features', component: FeaturesPage, meta: {requiresLogin: false}},
         { name: 'groupPlans', path: 'group-plans', component: GroupPlansPage, meta: {requiresLogin: false}},
diff --git a/website/server/controllers/api-v3/user.js b/website/server/controllers/api-v3/user.js
index 51ec44871..cdf5651b8 100644
--- a/website/server/controllers/api-v3/user.js
+++ b/website/server/controllers/api-v3/user.js
@@ -193,7 +193,6 @@ let updatablePaths = [
   'flags.showTour',
   'flags.tour',
   'flags.tutorial',
-  'flags.communityGuidelinesAccepted',
   'flags.welcomed',
   'flags.cardReceived',
   'flags.warnedLowHealth',
diff --git a/website/server/models/user/schema.js b/website/server/models/user/schema.js
index aeb11535c..71aa2c5ac 100644
--- a/website/server/models/user/schema.js
+++ b/website/server/models/user/schema.js
@@ -216,7 +216,6 @@ let schema = new Schema({
     // Used to enable weekly recap emails as users login
     lastWeeklyRecapDiscriminator: Boolean,
     onboardingEmailsPhase: String, // Keep track of the latest onboarding email sent
-    communityGuidelinesAccepted: {type: Boolean, default: false},
     cronCount: {type: Number, default: 0},
     welcomed: {type: Boolean, default: false},
     armoireEnabled: {type: Boolean, default: true},
