Author: aszlig <aszlig@nix.build>
Date:   Fri Mar 30 20:29:49 2018 +0200

    Remove community guidelines
    
    The standalone version is invite-only anyways and the community
    guidelines really vary from installation to installation, so let's get
    rid of that.
    
    Signed-off-by: aszlig <aszlig@nix.build>
    Filename: remove-community-guidelines.patch

diff --git a/website/client/components/chat/chatCard.vue b/website/client/components/chat/chatCard.vue
index df3d90209..0a684eba5 100644
--- a/website/client/components/chat/chatCard.vue
+++ b/website/client/components/chat/chatCard.vue
@@ -21,10 +21,9 @@ div
       span.action(v-if='!inbox', @click='copyAsTodo(msg)')
         .svg-icon(v-html="icons.copy")
         | {{$t('copyAsTodo')}}
-      span.action(v-if='!inbox && user.flags.communityGuidelinesAccepted && msg.uuid !== "system"', @click='report(msg)')
+      span.action(v-if='!inbox && msg.uuid !== "system"', @click='report(msg)')
         .svg-icon(v-html="icons.report")
         | {{$t('report')}}
-        // @TODO make flagging/reporting work in the inbox. NOTE: it must work even if the communityGuidelines are not accepted and it MUST work for messages that you have SENT as well as received. -- Alys
       span.action(v-if='msg.uuid === user._id || inbox || user.contributor.admin', @click='remove()')
         .svg-icon(v-html="icons.delete")
         | {{$t('delete')}}
diff --git a/website/client/components/groups/communityGuidelines.vue b/website/client/components/groups/communityGuidelines.vue
deleted file mode 100644
index 3fcc62f10..000000000
--- a/website/client/components/groups/communityGuidelines.vue
+++ /dev/null
@@ -1,47 +0,0 @@
-<template lang="pug">
-.row.community-guidelines(v-if='!communityGuidelinesAccepted')
-  div.col.col-sm-12.col-xl-8(v-once, v-html="$t('communityGuidelinesIntro')")
-
-  div.col-md-auto.col-md-12.col-xl-4
-    button.btn.btn-info.btn-follow-guidelines(@click='acceptCommunityGuidelines()', v-once) {{ $t('acceptCommunityGuidelines') }}
-</template>
-
-<style lang="scss">
-@import '~client/assets/scss/colors.scss';
-
-.community-guidelines {
-  background-color: rgba(135, 129, 144, 0.84);
-  padding: 1em;
-  color: $white;
-  position: absolute;
-  top: 0;
-  height: 150px;
-  margin-top: 2.3em;
-  width: 100%;
-  border-radius: 4px;
-  align-items: center;
-  justify-content: center;
-
-  .btn-follow-guidelines {
-    white-space: pre-line;
-  }
-}
-</style>
-
-<script>
-import { mapState } from 'client/libs/store';
-
-export default {
-  computed: {
-    ...mapState({user: 'user.data'}),
-    communityGuidelinesAccepted () {
-      return this.user.flags.communityGuidelinesAccepted;
-    },
-  },
-  methods: {
-    acceptCommunityGuidelines () {
-      this.$store.dispatch('user:set', {'flags.communityGuidelinesAccepted': true});
-    },
-  },
-};
-</script>
diff --git a/website/client/components/groups/group.vue b/website/client/components/groups/group.vue
index 647d4ad5b..c9125d840 100644
--- a/website/client/components/groups/group.vue
+++ b/website/client/components/groups/group.vue
@@ -37,7 +37,6 @@
             button.btn.btn-secondary.float-left(v-once, @click='reverseChat()') {{ $t('reverseChat') }}
           .col-6.chat-send-actions
             button.btn.btn-secondary.send-chat.float-right(v-once, @click='sendMessage()') {{ $t('send') }}
-        community-guidelines
         .row(v-if='showNoNotificationsMessage')
           .col-12.no-notifications
             | {{$t('groupNoNotifications')}}
@@ -332,7 +331,6 @@ import groupChallenges from '../challenges/groupChallenges';
 import groupGemsModal from 'client/components/groups/groupGemsModal';
 import questSidebarSection from 'client/components/groups/questSidebarSection';
 import markdownDirective from 'client/directives/markdown';
-import communityGuidelines from './communityGuidelines';
 
 import deleteIcon from 'assets/svg/delete.svg';
 import copyIcon from 'assets/svg/copy.svg';
@@ -363,7 +361,6 @@ export default {
     questDetailsModal,
     groupGemsModal,
     questSidebarSection,
-    communityGuidelines,
   },
   directives: {
     markdown: markdownDirective,
@@ -473,9 +470,6 @@ export default {
     },
   },
   methods: {
-    acceptCommunityGuidelines () {
-      this.$store.dispatch('user:set', {'flags.communityGuidelinesAccepted': true});
-    },
     async load () {
       if (this.isParty) {
         this.searchId = 'party';
diff --git a/website/client/components/groups/tavern.vue b/website/client/components/groups/tavern.vue
index 4f2fd97de..58bb3b46c 100644
--- a/website/client/components/groups/tavern.vue
+++ b/website/client/components/groups/tavern.vue
@@ -12,7 +12,7 @@
         h3(v-once) {{ $t('tavernChat') }}
 
         .row
-          textarea(:placeholder="$t('tavernCommunityGuidelinesPlaceholder')", v-model='newMessage', :class='{"user-entry": newMessage}', @keydown='updateCarretPosition', @keyup.ctrl.enter='sendMessage()')
+          textarea(v-model='newMessage', :class='{"user-entry": newMessage}', @keydown='updateCarretPosition', @keyup.ctrl.enter='sendMessage()')
           autocomplete(:text='newMessage', v-on:select="selectedAutocomplete", :coords='coords', :chat='group.chat')
 
         .row
@@ -22,8 +22,6 @@
           .col-6
             button.btn.btn-secondary.send-chat.float-right(v-once, @click='sendMessage()') {{ $t('send') }}
 
-        community-guidelines
-
         .row
           .hr.col-12
           chat-message(:chat.sync='group.chat', :group-id='group._id', :group-name='group.name')
@@ -133,8 +131,6 @@
               .svg-icon(v-html="icons.downIcon")
         .section.row(v-if="sections.helpfulLinks")
           ul
-            li
-             router-link(to='/static/community-guidelines', v-once) {{ $t('communityGuidelinesLink') }}
             li
               router-link(to="/groups/guild/f2db2a7f-13c5-454d-b3ee-ea1f5089e601") {{ $t('lookingForGroup') }}
             li
@@ -519,7 +515,6 @@ import { mapState } from 'client/libs/store';
 import { TAVERN_ID } from '../../../common/script/constants';
 import chatMessage from '../chat/chatMessages';
 import autocomplete from '../chat/autoComplete';
-import communityGuidelines from './communityGuidelines';
 import worldBossInfoModal from '../world-boss/worldBossInfoModal';
 import worldBossRageModal from '../world-boss/worldBossRageModal';
 
@@ -551,7 +546,6 @@ export default {
   components: {
     chatMessage,
     autocomplete,
-    communityGuidelines,
     worldBossInfoModal,
     worldBossRageModal,
   },
diff --git a/website/client/components/static/communityGuidelines.vue b/website/client/components/static/communityGuidelines.vue
deleted file mode 100644
index bcdfc5362..000000000
--- a/website/client/components/static/communityGuidelines.vue
+++ /dev/null
@@ -1,213 +0,0 @@
-<template lang="pug">
-  .container-fluid
-    h1 {{ $t('communityGuidelines') }}
-    hr
-    p {{ $t('lastUpdated') }} March 29, 2018
-
-    h2#welcome {{ $t('commGuideHeadingWelcome') }}
-    .media.align-items-center
-      img(src='~assets/images/community-guidelines/intro.png')
-      .media-body
-        p(v-html="$t('commGuidePara001')")
-        p(v-html="$t('commGuidePara002')")
-    p(v-html="$t('commGuidePara003')")
-    p(v-html="$t('commGuidePara004')")
-
-    h2#interactions {{ $t('commGuideHeadingInteractions') }}
-    .media.align-items-center
-      .media-body
-        p(v-html="$t('commGuidePara015')")
-        p(v-html="$t('commGuidePara016')")
-      img(src='~assets/images/community-guidelines/publicSpaces.png')
-    ul
-      li(v-html="$t('commGuideList02A')")
-      li(v-html="$t('commGuideList02B')")
-      li(v-html="$t('commGuideList02C')")
-      li(v-html="$t('commGuideList02D')")
-      li(v-html="$t('commGuideList02E')")
-      li(v-html="$t('commGuideList02F')")
-      li(v-html="$t('commGuideList02G')")
-      li(v-html="$t('commGuideList02H')")
-      li(v-html="$t('commGuideList02I')")
-      li(v-html="$t('commGuideList02J')")
-      li(v-html="$t('commGuideList02K')")
-      li(v-html="$t('commGuideList02L')")
-    p(v-html="$t('commGuidePara019')")
-    p(v-html="$t('commGuidePara020')")
-    p(v-html="$t('commGuidePara020A')")
-    p(v-html="$t('commGuidePara021')")
-
-    h3#tavern {{ $t('commGuideHeadingTavern') }}
-    .media.align-items-center
-      img(src='~assets/images/community-guidelines/tavern.png')
-      .media-body
-        p(v-html="$t('commGuidePara022')")
-        p(v-html="$t('commGuidePara023')")
-        p(v-html="$t('commGuidePara024')")
-    .media.align-items-center
-      .media-body
-        p(v-html="$t('commGuidePara027')")
-      img(src='~assets/images/community-guidelines/backCorner.png')
-
-    h3#guilds {{ $t('commGuideHeadingPublicGuilds') }}
-    .media.align-items-center
-      .media-body
-        p(v-html="$t('commGuidePara029')")
-        p(v-html="$t('commGuidePara031')")
-      img(src='~assets/images/community-guidelines/publicGuilds.png')
-    p(v-html="$t('commGuidePara033')")
-    p(v-html="$t('commGuidePara035')")
-    p(v-html="$t('commGuidePara036')")
-    p(v-html="$t('commGuidePara037')")
-    p(v-html="$t('commGuidePara038')")
-
-    h2#infractions-consequences-restoration {{ $t('commGuideHeadingInfractionsEtc') }}
-    h3#infractions {{ $t('commGuideHeadingInfractions') }}
-    .media.align-items-center
-      img(src='~assets/images/community-guidelines/infractions.png')
-      .media-body
-        p(v-html="$t('commGuidePara050')")
-        p(v-html="$t('commGuidePara051')")
-    h4 {{ $t('commGuideHeadingSevereInfractions') }}
-    p(v-html="$t('commGuidePara052')")
-    p(v-html="$t('commGuidePara053')")
-    ul
-      li(v-html="$t('commGuideList05A')")
-      li(v-html="$t('commGuideList05B')")
-      li(v-html="$t('commGuideList05C')")
-      li(v-html="$t('commGuideList05D')")
-      li(v-html="$t('commGuideList05E')")
-      li(v-html="$t('commGuideList05F')")
-      li(v-html="$t('commGuideList05G')")
-    h4 {{ $t('commGuideHeadingModerateInfractions') }}
-    p(v-html="$t('commGuidePara054')")
-    p(v-html="$t('commGuidePara055')")
-    ul
-      li(v-html="$t('commGuideList06A')")
-      li(v-html="$t('commGuideList06B')")
-      li(v-html="$t('commGuideList06C')")
-      li(v-html="$t('commGuideList06D')")
-      li(v-html="$t('commGuideList06E')")
-    h4 {{ $t('commGuideHeadingMinorInfractions') }}
-    p(v-html="$t('commGuidePara056')")
-    p(v-html="$t('commGuidePara057')")
-    ul
-      li(v-html="$t('commGuideList07A')")
-      li(v-html="$t('commGuideList07B')")
-    p(v-html="$t('commGuidePara057A')")
-
-    h3#consequences {{ $t('commGuideHeadingConsequences') }}
-    .media.align-items-center
-      .media-body
-        p(v-html="$t('commGuidePara058')")
-        p(v-html="$t('commGuidePara059')")
-      img(src='~assets/images/community-guidelines/consequences.png')
-    p(v-html="$t('commGuidePara060')")
-    ul
-      li(v-html="$t('commGuideList08A')")
-      li(v-html="$t('commGuideList08B')")
-      li(v-html="$t('commGuideList08C')")
-    p(v-html="$t('commGuidePara060A')")
-    p(v-html="$t('commGuidePara060B')")
-    h4 {{ $t('commGuideHeadingSevereConsequences') }}
-    ul
-      li(v-html="$t('commGuideList09A')")
-      li(v-html="$t('commGuideList09C')")
-    h4 {{ $t('commGuideHeadingModerateConsequences') }}
-    ul
-      li {{ $t('commGuideList10A') }}
-        ul
-          li {{ $t('commGuideList10A1') }}
-      li(v-html="$t('commGuideList10C')")
-      li(v-html="$t('commGuideList10D')")
-      li(v-html="$t('commGuideList10E')")
-      li(v-html="$t('commGuideList10F')")
-    h4 {{ $t('commGuideHeadingMinorConsequences') }}
-    ul
-      li(v-html="$t('commGuideList11A')")
-      li(v-html="$t('commGuideList11B')")
-      li(v-html="$t('commGuideList11C')")
-      li(v-html="$t('commGuideList11D')")
-      li(v-html="$t('commGuideList11E')")
-
-    h3#restoration {{ $t('commGuideHeadingRestoration') }}
-    .media.align-items-center
-      img(src='~assets/images/community-guidelines/restoration.png')
-      .media-body
-        p(v-html="$t('commGuidePara061')")
-        p(v-html="$t('commGuidePara062')")
-    p(v-html="$t('commGuidePara063')")
-
-    h2#meet-the-mods {{ $t('commGuideHeadingMeet') }}
-    p(v-html="$t('commGuidePara006')")
-    p(v-html="$t('commGuidePara007')")
-    p(v-html="$t('commGuidePara008')")
-    p(v-html="$t('commGuidePara009')")
-    .media.align-items-center
-      img(src='~assets/images/community-guidelines/staff.png')
-      .media-body
-        ul
-          li {{ $t('commGuideAKA', {habitName: 'Beffymaroo', realName: 'Beth'}) }}
-          li {{ $t('commGuideAKA', {habitName: 'Viirus', realName: 'Phillip'}) }}
-          li {{ $t('commGuideAKA', {habitName: 'redphoenix', realName: 'Vicky'}) }} ({{ $t('commGuideOnTrello', {trelloName: 'caffeinatedvee'}) }}, {{ $t('commGuideOnGitHub', {gitHubName: 'veeeeeee'}) }})
-          li {{ $t('commGuideAKA', {habitName: 'Lemoness', realName: 'Leslie'}) }} ({{ $t('commGuideOnTrello', {trelloName: 'lemonesstree'}) }})
-          li {{ $t('commGuideAKA', {habitName: 'SabreCat', realName: 'Sabe'}) }}
-          li {{ $t('commGuideAKA', {habitName: 'paglias', realName: 'Matteo'}) }}
-          li {{ $t('commGuideAKA', {habitName: 'TheHollidayInn', realName: 'Keith'}) }}
-    p(v-html="$t('commGuidePara010')")
-    .media.align-items-center
-      img(src='~assets/images/community-guidelines/moderators.png')
-      .media-body
-        p(v-html="$t('commGuidePara011')")
-        ul
-          li Bailey (It's Bailey {{ $t('commGuidePara011a') }})
-          li Ryan (deilann {{ $t('commGuidePara011b') }})
-          li Cantras
-          li Alys (LadyAlys {{ $t('commGuidePara011c') }})
-          li Fox_town
-          li Blade ({{ $t('commGuideOnGitHub', {gitHubName: 'crookedneighbor'}) }})
-          li Daniel the Bard
-          li shanaqui
-          li Dewines
-          li Megan
-          li Breadstrings
-    p(v-html="$t('commGuidePara012')")
-    p(v-html="$t('commGuidePara013')")
-    p {{ $t('commGuidePara014') }}&nbsp;
-      em lefnire, Slappybag, litenull, Shaner, Bobbyroberts99, wc8
-
-    h2#final {{ $t('commGuideHeadingFinal') }}
-    p(v-html="$t('commGuidePara067')")
-    p(v-html="$t('commGuidePara068')")
-
-    h2#links {{ $t('commGuideHeadingLinks') }}
-    ul
-      li(v-html="$t('commGuideLink01')")
-      li(v-html="$t('commGuideLink02')")
-      li(v-html="$t('commGuideLink03')")
-      li(v-html="$t('commGuideLink04')")
-      li(v-html="$t('commGuideLink05')")
-      li(v-html="$t('commGuideLink06')")
-      li(v-html="$t('commGuideLink07')")
-    p(v-html="$t('commGuidePara069')")
-    ul.list-2col.list-unstyled
-      li Breadstrings
-      li Draayder
-      li Kiwibot
-      li Leephon
-      li Lemoness
-      li Luciferian
-      li Revcleo
-      li Shaner
-      li Starsystemic
-      li UncommonCriminal
-</template>
-
-<style lang='scss' scoped>
-  .list-2col {
-    width: 50%;
-    columns: 2;
-    -moz-columns: 2;
-    -webkit-columns: 2;
-  }
-</style>
diff --git a/website/client/components/userMenu/profile.vue b/website/client/components/userMenu/profile.vue
index 27f48e4b4..a37a7ec6a 100644
--- a/website/client/components/userMenu/profile.vue
+++ b/website/client/components/userMenu/profile.vue
@@ -79,8 +79,6 @@ div
       .row(v-if='editing')
         h1 {{$t('editProfile')}}
         .col-12
-          .alert.alert-info.alert-sm(v-html='$t("communityGuidelinesWarning", managerEmail)')
-
           .form-group
             label {{ $t('displayName') }}
             input.form-control(type='text', :placeholder="$t('fullName')", v-model='editingProfile.name')
diff --git a/website/client/router.js b/website/client/router.js
index caa1a22f3..d8670a57f 100644
--- a/website/client/router.js
+++ b/website/client/router.js
@@ -13,7 +13,6 @@ const HomePage = () => import(/* webpackChunkName: "entry" */'./components/stati
 
 const AppPage = () => import(/* webpackChunkName: "static" */'./components/static/app');
 const ClearBrowserDataPage = () => import(/* webpackChunkName: "static" */'./components/static/clearBrowserData');
-const CommunityGuidelinesPage = () => import(/* webpackChunkName: "static" */'./components/static/communityGuidelines');
 const FAQPage = () => import(/* webpackChunkName: "static" */'./components/static/faq');
 const FeaturesPage = () => import(/* webpackChunkName: "static" */'./components/static/features');
 const GroupPlansPage = () => import(/* webpackChunkName: "static" */'./components/static/groupPlans');
@@ -250,7 +249,6 @@ const router = new VueRouter({
       children: [
         { name: 'app', path: 'app', component: AppPage, meta: {requiresLogin: false}},
         { name: 'clearBrowserData', path: 'clear-browser-data', component: ClearBrowserDataPage, meta: {requiresLogin: false}},
-        { name: 'communityGuidelines', path: 'community-guidelines', component: CommunityGuidelinesPage, meta: {requiresLogin: false}},
         { name: 'faq', path: 'faq', component: FAQPage, meta: {requiresLogin: false}},
         { name: 'features', path: 'features', component: FeaturesPage, meta: {requiresLogin: false}},
         { name: 'groupPlans', path: 'group-plans', component: GroupPlansPage, meta: {requiresLogin: false}},
diff --git a/website/server/controllers/api-v3/user.js b/website/server/controllers/api-v3/user.js
index e28514988..e72d12147 100644
--- a/website/server/controllers/api-v3/user.js
+++ b/website/server/controllers/api-v3/user.js
@@ -182,7 +182,6 @@ let updatablePaths = [
   'flags.showTour',
   'flags.tour',
   'flags.tutorial',
-  'flags.communityGuidelinesAccepted',
   'flags.welcomed',
   'flags.cardReceived',
   'flags.warnedLowHealth',
diff --git a/website/server/models/user/schema.js b/website/server/models/user/schema.js
index c1738b5e7..51f8e2864 100644
--- a/website/server/models/user/schema.js
+++ b/website/server/models/user/schema.js
@@ -222,7 +222,6 @@ let schema = new Schema({
     // Used to enable weekly recap emails as users login
     lastWeeklyRecapDiscriminator: Boolean,
     onboardingEmailsPhase: String, // Keep track of the latest onboarding email sent
-    communityGuidelinesAccepted: {type: Boolean, default: false},
     cronCount: {type: Number, default: 0},
     welcomed: {type: Boolean, default: false},
     armoireEnabled: {type: Boolean, default: true},
